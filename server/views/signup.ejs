
<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
    <title>Virtual Advisor</title>

    <!-- For-Mobile-Apps -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="Exchange Education a Responsive Web Template, Bootstrap Web Templates, Flat Web Templates, Android Compatible Web Template, Smartphone Compatible Web Template, Free Web Designs for Nokia, Samsung, LG, Sony Ericsson, Motorola Web Design" />
    <script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
    <!-- //For-Mobile-Apps -->

    <!-- Custom Theme files -->
    <!-- Bootstrap Styling --> <link rel='stylesheet' href="css/bootstrap.css" type='text/css' />
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) --> <script src="js/jquery.min.js"></script>
    <!-- Bootstrap-Working-File --> <script src="js/bootstrap.min.js"></script>
    <!-- Index-Page-Styling --> <link rel="stylesheet" href="css/style.css" type="text/css" media="all" />
    <!-- Owl-Carousel-Styling --> <link rel="stylesheet" href="css/owl.carousel.css" type="text/css" media="all">
    <!-- //Custom Theme files -->

    <!-- Smooth-Scrolling -->
    <script type="text/javascript" src="js/move-top.js"></script>
    <script type="text/javascript" src="js/easing.js"></script>
    <script type="text/javascript">
        jQuery(document).ready(function($) {
            $(".scroll").click(function(event){
                event.preventDefault();
                $('html,body').animate({scrollTop:$(this.hash).offset().top},1200);
            });
        });
    </script>
    <!-- //Smooth-Scrolling -->

    <!-- Calender-JavaScript -->
    <link rel="stylesheet" href="css/clndr.css" type="text/css" />
    <script src="js/underscore-min.js" type="text/javascript"></script>
    <script src= "js/moment-2.2.1.js" type="text/javascript"></script>
    <script src="js/clndr.js" type="text/javascript"></script>
    <script src="js/site.js" type="text/javascript"></script>
    <!-- //Calender-JavaScript -->

</head>


<!-- Body-Starts-Here -->
<body>

<!-- Header-Starts-Here -->
<div class="header">

    <!-- Navbar-Starts-Here -->
    <nav class="navbar navbar-inverse">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

                <!-- Logo --><a class="navbar-brand" href="#">Virtual Advisor</a><!-- //Logo -->

            </div>



        </div>
    </nav>
    <!-- //Navbar-Ends-Here -->

    <!-- Carousel-Starts-Here -->

    <!-- //Carousel-Ends-Here -->

</div>
<script>
    var app = angular.module('depApp', []);
    app.controller('dropdownDepartments', function ($scope, $http) {

        $scope.LoadMajors=function(program)
        {
            $scope.certificate="";
            $scope.minor="";
            $scope.courses = []

            $http.post('http://localhost:3000/api/req'
                    ,{ 'id' : program._id[0] }).success(function(result)
            {

                courses=result.Requirements.Core[0].Courses;
                if (courses.length > 0)
                {
                    // Looping through the course list for Majors
                    for(var i = 0; i < courses.length; i++)
                    {
                        $scope.courses.push(courses[i]);
                    }

                }


            });
        };

        $scope.LoadMinors=function(program)
        {
            $scope.certificate="";
            $scope.major="";

            $scope.courses = []
            $http.post('http://localhost:3000/api/req'
                    ,{ 'id' : program._id[0] }).success(function(result)
            {

                courses = result.CoursesList[0].Courses;
                if(courses.length > 0)
                {
                    //Looping through the course list for certificates
                    for(var i = 0; i < result.length; i++)
                    {
                        $scope.courses.push(result.CoursesList[i]);
                    }
                }

            });
        };

        $scope.LoadCertificates=function(program)
        {
            $scope.major="";
            $scope.minor="";

            $scope.courses = []
            $http.post('http://localhost:3000/api/req'
                    ,{ 'id' : program._id[0] }).success(function(result)
            {
                for(var i=0;i<result.CoursesList.length;i++) {
                    for (var j = 0; j < result.CoursesList[i].Courses.length; j++) {
                        $scope.courses.push(result.CoursesList[i].Courses[j]);
                    }
                }

            });
        };

        $scope.loadPrograms=function(department)
        {


            $scope.majors=[]
            $scope.minors=[]
            $scope.certificates=[]
            $http.post('http://localhost:3000/api/programs'
                    ,{ 'department' : department }).success(function(result)
            {

                for(i=0;i<result.length;i++)
                {
                    type = [result[i].Type]
                    if(type=="Major")
                        $scope.majors.push({"Title":[result[i].Title],"_id":[result[i]._id]});
                    else if(type=="Minor")
                        $scope.minors.push({"Title":[result[i].Title],"_id":[result[i]._id]});
                    else if(type=="Certificate")
                        $scope.certificates.push({"Title":[result[i].Title],"_id":[result[i]._id]});


                }


            });
        };
        $scope.departments = [];
        $http.get('http://localhost:3000/api/departments').success(function (result) {
            $scope.departments = result

        });

        $scope.electives = [{id: 'elective1','name':'','code':''}, {id: 'elective2','name':'','code':''}, {id: 'elective3','name':'','code':''}];
        $scope.addNewElective=function()
        {
            var newItemNo = $scope.electives.length+1;
            $scope.electives.push({'id':'elective'+newItemNo});
        };
        $scope.GetClassName = function(id,code)
        {
            var electives = $scope.electives;
            for (var i = 0; i < electives.length; i++)
            {
                if (electives[i].id == id) {
                    electives[i].name = '';
                }
            }
            code = code.toUpperCase();
            var res = /[A-Z][A-Z]?[A-Z]?[A-Z]?\s*[0-9][0-9][0-9]/.exec(code);
            if(res.length > 0)
            {

                for (var i = 0; i < electives.length; i++) {
                    if (electives[i].id == id)
                    {
                        $scope.index = i;
                        $http.post('http://localhost:3000/api/course',{'course_code': code}).success(function (result)
                        {
                            electives[$scope.index ].name=result[0].Title;

                        });



                    }
                }
            }
        }
        $scope.CheckExistingAccounts = function(email)
        {
            $scope.emailexist='';
            var res = /[A-Z][A-Z][A-Z][A-Z]?[A-Z]?[A-Z]?[A-Z]?[A-Z]?@(stevens\.edu)/i.exec(email);
           if(res!=null)
           {
            $http.post('http://localhost:3000/api/checkAccount',{'Email':email}).success(function(result)
            {

                if(result.Account=='exist')
                {
                    $scope.emailexist="Account already Exist";
                }

                else
                {
                    $scope.emailexist="Email is good";
                }
            });
        }
        else
           {
               $scope.emailexist = "Email not valid";
           }
        }
        $scope.Checkpassword = function()
        {
            $scope.passcheck='';
            if($scope.password!=null)
            {
                if($scope.password.length>=4)
                {
                    $scope.passcheck ="Password is good";
                }
                else
                {
                    $scope.passcheck ="Please enter a valid password";
                }
            }
        }
        $scope.CheckConfirm=function()
        {
            if($scope.password==$scope.passconfirm)
            {
                $scope.confirmcheck="confirmation is matched";
            }
            else
            {
                $scope.confirmcheck="confirmation mismatch";
            }
        }


    });

</script>
<center>
<form class="form-group" action='' method="POST"  ng-app="depApp" ng-controller="dropdownDepartments" ng-sumit="submit()"b>
    <fieldset>
        <div id="legend">
            <legend class="">Register</legend>
        </div>
        <div class="form-group">
            <!-- Username -->
            <label class="control-label"  for="First Name">First Name</label>
                <input type="text" id="firstname" ng-model="firstname" placeholder="" class="input-xlarge">
            <br>
            <label class="control-label"  for="Last Name">Last Name</label>
                 <input type="text" id="lastname" name="lastname" placeholder="" class="input-xlarge">
            <br>
            <!-- E-mail -->
            <label class="control-label" for="email">Stevens E-mail</label>
                <input type="text" ng-change="CheckExistingAccounts(email)" id="email" ng-model="email" placeholder="" class="input-xlarge">
            <label class="control-label" for="email" ng-model="emailexist">{{emailexist}}</label>


        </div>



        <div class="form-group">
            <!-- Password-->
            <label class="control-label" for="password">Password</label>
            <div class="form-group">
                <input type="password" id="password" ng-model="password" class="input-xlarge" ng-change="Checkpassword()">
                <label class="control-label" ng-model="passcheck">{{passcheck}}</label>
                <p class="help-block">Password should be at least 4 characters</p>
            </div>
        </div>

        <div class="form-group">
            <!-- Password -->
            <label class="control-label"  for="password_confirm">Password (Confirm)</label>
            <div class="form-group">
                <input type="password"  id="password_confirm"  ng-model="passconfirm" class="input-xlarge" ng-change="CheckConfirm()">
                <label class="control-label" ng-model="confirmcheck">{{confirmcheck}}</label>


            </div>
        </div>
        <label>Select Your Program</label>
        <label for="dept">Departments: </label>
        <select id="dept" style="width: 20em;" ng-model="department" ng-change="loadPrograms(department)"  ng-options="d for d in departments">
        </select>
        <br>
        <br>

        <label>Majors: </label>
        <select  style="width: 20em;" ng-model="major" ng-change="LoadMajors(major)" ng-options="p.Title for p in majors">
        </select>

        <label>Minors: </label>
        <select   style="width: 20em;" ng-model="minor" ng-change="LoadMinors(minor)" ng-options="p.Title for p in minors">
        </select>

        <label>Certificates: </label>
        <select   style="width: 20em;" ng-model="certificate" ng-change="LoadCertificates(certificate)" ng-options="p.Title for p in certificates">
        </select>

        <div class="form-group">
            <label>Core Classes</label>
            <div ng-repeat="course in courses">

                <input type="checkbox"  >{{course}}<br>
            </div>

        </div>
        <div class="form-group">
        <label>Electives</label>
        <div ng-repeat="elective in electives">
            <input type="text" ng-model="elective.code" name="" ng-change="GetClassName(elective.id,elective.code)"  placeholder="Ex: SW 555">
            <label ng-model="elective.name">{{elective.name}}</label>
        </div>
            <button type="button" ng-click="addNewElective()">Add More</button>
        </div>
        <div class="form-group">
            <!-- Button -->
            <div class="form-group">
                <button class="btn btn-success">Register</button>
            </div>
        </div>
    </fieldset>
</form>
</center>



</body>
</html>